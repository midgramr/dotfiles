# TODO: minimize config (remove Oh-My-ZSH)
# TODO: modularize configs (integrate each app's config with stow)

export EDITOR=nvim

# Oh-My-ZSH config
export ZSH="$HOME/.oh-my-zsh"

# See https://github.com/ohmyzsh/ohmyzsh/wiki/Themes
ZSH_THEME="minimal"

# Update automatically without asking
zstyle ':omz:update' mode auto

plugins=(
  git
  autojump
  eza
  vi-mode
)

source $ZSH/oh-my-zsh.sh
# Oh-My-ZSH config end

# Setup completions
fpath=(~/.zsh.d/ $HOME/.docker/completions $fpath)
autoload -U compinit
compinit

source "$(brew --prefix nvm)/nvm.sh"
export HOMEBREW_FORCE_VENDOR_RUBY=1
export HOMEBREW_NO_ENV_HINTS=1

export MANPAGER='nvim +Man! +"set so=99"'
export JAVA_HOME=$(/usr/libexec/java_home 2>/dev/null)

# fzf
# TODO: create zsh widget (?) to automatically become nvim process after exit
# NOTE: this could be done a in hacky way by repurposing the existing cmdline
# completion, but the tool's author suggested creating some custom binding
export FZF_DEFAULT_OPTS="--style=minimal --cycle --layout=reverse --highlight-line --gutter=' ' --pointer='>'"
export FZF_CTRL_T_OPTS="--walker-skip .git,node_modules,target"
source <(fzf --zsh)

_fzf_complete_ls() {
  _fzf_complete -- "$@" < <(fd -t d)
}

_fzf_complete_nvim() {
  _fzf_complete -- "$@" < <(fd -t f)
}

export _ZO_FZF_OPTS="$FZF_DEFAULT_OPTS --preview='echo {} | cut -w -f3 | eza --color=always' --preview-window='down'"
eval "$(zoxide init zsh)"

# Cht.sh
CHTSH_QUERY_OPTIONS="T"

# Zsh help utility
export HELPDIR=/usr/share/zsh/$ZSH_VERSION/help
unalias run-help
autoload run-help
alias help=run-help

# Kitty binaries
export PATH=$PATH:/Applications/kitty.app/Contents/MacOS

# Go binaries
export PATH=$PATH:~/go/bin

# Enable core dumps for Neovim dev
ulimit -c unlimited

alias interact='~/Development/projects/stuff/interact.py --color'
alias fd='fd -H -E .git'
alias bat='bat --theme-dark gruvbox-dark'

function nvimhelp {
  nvim +"help $1" +only +"no q <Cmd>q<CR>"
}

source $(brew --prefix)/share/zsh-autosuggestions/zsh-autosuggestions.zsh

# pnpm
export PNPM_HOME="/Users/n1v3x/Library/pnpm"
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac
# pnpm end

# vim: ft=zsh
